{
  "info": {
    "name": "Mock Endpoints (Local)",
    "_postman_id": "e7a4bc78-7c8a-4b04-93a1-7f9d878b6c1d",
    "description": "Collection for hitting the mock HTTP endpoints served by the project. Import this along with the matching environment file to run smoke tests locally.",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080"
    },
    {
      "key": "playerName",
      "value": "MockPostman"
    },
    {
      "key": "guessWord",
      "value": "MOCKS"
    }
  ],
  "item": [
    {
      "name": "Join (POST /join)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"player_name\": \"{{playerName}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/join",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "join"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Status is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Lobby state returned\", function () {",
              "    const json = pm.response.json();",
              "    pm.expect(json).to.have.property(\"players_list\");",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Leave (DELETE /leave)",
      "request": {
        "method": "DELETE",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"player_name\": \"{{playerName}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/leave",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "leave"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Status is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Lobby list exists\", function () {",
              "    const json = pm.response.json();",
              "    pm.expect(json).to.have.property(\"players_list\");",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Ready (POST /ready)",
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"player_name\": \"{{playerName}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/ready",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "ready"
          ]
        }
      },
      "response": [],
      "event": [
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Status is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Lobby contains player\", function () {",
              "    const json = pm.response.json();",
              "    pm.expect(json.players_list.map(p => p.player_name)).to.include(pm.collectionVariables.get(\"playerName\"));",
              "});"
            ]
          }
        }
      ]
    },
    {
      "name": "Get State (GET /)",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "// Timestamp is optional in mock but present in real request body",
              "pm.collectionVariables.set(\"timestamp\", Math.floor(Date.now() / 1000));"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Status is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Active game returned\", function () {",
              "    const json = pm.response.json();",
              "    pm.expect(json).to.have.property(\"game\");",
              "    pm.expect(json).to.have.property(\"round_duration\");",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/?player_name={{playerName}}&timestamp={{timestamp}}",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            ""
          ],
          "query": [
            {
              "key": "player_name",
              "value": "{{playerName}}"
            },
            {
              "key": "timestamp",
              "value": "{{timestamp}}"
            }
          ]
        }
      },
      "response": []
    },
    {
      "name": "Guess (POST /guess)",
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.collectionVariables.set(\"timestamp\", Math.floor(Date.now() / 1000));"
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "exec": [
              "pm.test(\"Status is 200\", function () {",
              "    pm.response.to.have.status(200);",
              "});",
              "",
              "pm.test(\"Guess result present\", function () {",
              "    const json = pm.response.json();",
              "    pm.expect(json).to.have.property(\"state\");",
              "    pm.expect(json).to.have.property(\"guess_result\");",
              "});"
            ]
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n    \"player_name\": \"{{playerName}}\",\n    \"timestamp\": {{timestamp}},\n    \"guess\": \"{{guessWord}}\"\n}"
        },
        "url": {
          "raw": "{{baseUrl}}/guess",
          "host": [
            "{{baseUrl}}"
          ],
          "path": [
            "guess"
          ]
        }
      },
      "response": []
    }
  ]
}

